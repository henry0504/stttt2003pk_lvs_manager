{% extends "index.html" %}
{% block body %}

  <div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
        <ul class="nav nav-tabs">
          <li><a href="/lvsmanager/">Lvs Cluster Manager</a><span></span></li>
          <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                Keepalived Operation Using Salt <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
                <li class="active"><a href="/lvsmanager_keepalived_reload/?id={{ cluster.id }}">Keepalived Reload</a></li>
                <li><a href="/lvsmanager_keepalived_start_or_stop/?id={{ cluster.id }}">Keepalived Start/Stop</a></li>
                <li><a href="/lvsmanager_keepalived_ipvsadm/?id={{ cluster.id }}">Get Ipvsadmin Stats</a></li>
            </ul>
          </li>
        </ul>
        </div>
    </div>
  </div>
  </br>

<div class="container-fluid">
    <div class="row">
  <div class="col-md-12">
  <h4>{{ cluster.id }}</h4>
    {% if current_user is user_is_manager %} 
    <table id="lvsmanager_table" class="table table-bordered table-hover">
    <tr>
        <th style="width: 15%">Cluster_Id</th>
        <th style="width: 15%">Description</th>
        <th style="width: 10%">Idc_Area</th>
        <th style="width: 10%">Load_Balancer_Server</th>
    </tr>
    {% if cluster %}
    <tr>
        <td>{{ cluster.id }}</td>
        <td>{{ cluster.descript }}</td>
        <td>{{ cluster.area }}</td>
        <td>{% for lb in cluster.lb %}
            {{ lb.id }}:{{ lb.ipadd }}:{{ lb.port }}{% endfor %}</td>
    </tr>
    {% endif %}
    </table>
    {% endif %}
  </div>
    </div>
</div>

  <div class="container-fluid">
    <h4>Choose The Lvs Server To Run Reload Keepalived</h4>
    <div class="row">
        <div class="col-md-6">
    <ol id="lvsmanager_keepalived_reload_select">
        {% for lb in cluster.lb %}
        <li class="ui-widget-content">{{ lb.id }}/{{ lb.ipadd }}</li>
        {% endfor %}
    </ol>
    <button id="lvsmanager_keepalived_reload_run" class="btn inline btn-primary" style="position:relative ; top:5px ">Reload</button>
        </div>
    </div>
  </div>
    </br>

    <div class="container-fluid">
    <h4>Salt Result</h4>
        <div class="row">
            <div class="col-md-12">
                <pre id="lvsmanager_keepalived_reload_return_text">

                </pre>
            </div>
        </div>
    </div>

<script type="text/javascript">
    //$("#lvsmanager_keepalived_reload_select").selectpicker({style: 'btn-info', menuStyle: 'dropdown-inverse'});
    $(function(){
        $("#lvsmanager_keepalived_reload_select").selectable();
    });
</script>

{% endblock %}
